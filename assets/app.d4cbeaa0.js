import{a as I,v as z,r as E,w as v,o as d,c as h,b as a,F as A,d as b,t as _,e as S,f as x,g as w,h as u,i as q,j as m,k as V,m as D,D as L,l as $,n as O,p as P,q as T,s as U,C as j,u as N,x as W,H as R,y as B,z as H}from"./vendor.60f6099b.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=o(e);fetch(e.href,n)}})();window.axios=I;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const g=(s,t)=>{const o=s.__vccOpts||s;for(const[i,e]of t)o[i]=e;return o},M={props:{options:Array,default:{type:Array,default:()=>[]}},data(){return{show:!1,selected:this.default}},methods:{showDropdown(){this.show=!this.show},hide(){this.show=!1},groupBy(s,t){return s.reduce((o,i,e)=>{var n;return(o[n=t(i,e,s)]||(o[n]=[])).push(i),o},{})}},computed:{groups(){return this.options[0].hasOwnProperty("group")?this.groupBy(this.options,s=>s.group):this.options}},watch:{selected(s){this.$emit("checked",s)}},directives:{clickOutside:z.directive}},J={class:"dd"},K={id:"list1",class:"dropdown-check-list",tabindex:"100"},X={key:0,class:"items"},Q={key:0},G=["id","value"],Y=["for"],Z={key:1},tt=["id","value"],et=["for"];function st(s,t,o,i,e,n){const c=E("click-outside");return v((d(),h("div",J,[a("div",K,[a("span",{class:"anchor form-control",onClick:t[0]||(t[0]=(...l)=>n.showDropdown&&n.showDropdown(...l))},"Select Parameter"),e.show?(d(),h("ul",X,[(d(!0),h(A,null,b(n.groups,(l,r)=>(d(),h("li",{key:r},[Array.isArray(l)?(d(),h("div",Q,[a("span",null,_(r),1),(d(!0),h(A,null,b(l,(p,y)=>(d(),h("div",{key:y},[v(a("input",{type:"checkbox",id:y,value:p,"onUpdate:modelValue":t[1]||(t[1]=F=>e.selected=F)},null,8,G),[[S,e.selected]]),a("label",{for:y},_(s.$filters.textFormat(p.text)),9,Y)]))),128))])):x("",!0),Array.isArray(l)?x("",!0):(d(),h("div",Z,[v(a("input",{type:"checkbox",id:r,value:l,"onUpdate:modelValue":t[2]||(t[2]=p=>e.selected=p)},null,8,tt),[[S,e.selected]]),a("label",{for:r},_(s.$filters.textFormat(l.text)),9,et)]))]))),128))])):x("",!0)])])),[[c,n.hide]])}const C=g(M,[["render",st]]);const k=["#2f7ed8","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a","#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1","#0d233a"];const ot={props:{url:String,title:String,defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Datepicker:w,Dropdown:C},data(){return{items:this.defaultData,params:{from:new Date,to:new Date,interval:3600,limit:1e3,select:[]},data:[],realtime:{},fetchReady:!1,colors:k,options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!0},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{pointFormat:"{series.name}: <b>{point.y:.2f}</b><br/>",crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},mounted(){this.fetchData()},methods:{interval(s){this.params.interval=s,this.fetchData()},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[],o=[];this.items.forEach((i,e)=>{let n=this.colors[e];t[e]={title:{text:this.textFormat(i.text),style:{color:n,fontSize:"16px"}},lineColor:n,labels:{style:{color:n},align:"left",x:14},lineWidth:1,opposite:!0},i.range&&(t[e].min=i.range[0],t[e].max=i.range[1]),s[e]={id:i.data,yAxis:e,type:i.type?i.type:"spline",name:this.textFormat(i.text),color:n,lineWidth:1,data:[]},o[e]=i.data}),this.options.series=s,this.options.yAxis=t,this.params.select=o,await axios.get(this.url,{params:this.params}).then(i=>{i.data.data.forEach(n=>{let c=n.unix_time;for(const l in n){let r=this.options.series.findIndex(p=>p.id===l);r>=0&&this.options.series[r].data.push([c,n[l]])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")}}},nt={class:"report"},it={class:"table-wrapper"},at={class:"toolbox"},rt={class:"date-selected"},lt=V('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),ct=[lt],pt={class:"chart"};function dt(s,t,o,i,e,n){const c=m("dropdown"),l=m("datepicker"),r=m("highcharts");return d(),h("div",nt,[a("div",it,[a("div",at,[u(c,{options:o.columns,onChecked:n.selected,default:o.defaultData},null,8,["options","onChecked","default"]),a("div",rt,[u(l,{class:"mr-2",type:"datetime",modelValue:e.params.from,"onUpdate:modelValue":t[0]||(t[0]=p=>e.params.from=p),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),u(l,{class:"mr-2",type:"datetime",modelValue:e.params.to,"onUpdate:modelValue":t[1]||(t[1]=p=>e.params.to=p),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),v(a("select",{"onUpdate:modelValue":t[2]||(t[2]=p=>e.params.interval=p),class:"form-control wd-80 mr-2"},ct,512),[[q,e.params.interval]]),a("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...p)=>n.fetchData&&n.fetchData(...p))},"Show")])]),a("div",pt,[u(r,{ref:"chart",class:"hc","constructor-type":"stockChart",options:e.options},null,8,["options"])])])])}const ht=g(ot,[["render",dt]]),ut={props:{url:String,title:String,mqtt:{type:Object,default(s){return{url:null,username:null,password:null,topic:null,timefield:"_terminalTime"}}},defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Dropdown:C},data(){return{items:this.defaultData,mqttConnection:null,colors:k,params:{last:30},options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!1},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{pointFormat:"{series.name}: <b>{point.y:.2f}</b><br/>",crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},created(){this.mqttConnection=D.exports.connect(this.mqtt.url,{username:this.mqtt.username,password:this.mqtt.password})},mounted(){this.fetchData(),this.listen()},methods:{listen(){if(this.mqttConnection){let s=this;this.mqttConnection.on("connect",function(){s.mqttConnection.subscribe(s.mqtt.topic,function(t){t||console.log("connected")})}),this.mqttConnection.on("message",this.received)}},received(s,t){let o=JSON.parse(t.toString()),i=this.mqtt.timefield?this.mqtt.timefield:"_terminalTime",e=Date.parse(o[i]);for(const n in o){let c=this.options.series.findIndex(l=>l.id===n);c>=0&&(this.options.series[c].data.shift(),this.options.series[c].data.push([e,parseInt(o[n])]))}},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[];this.mqttI&&this.mqttI.end(),this.items.forEach((o,i)=>{let e=this.colors[i];t[i]={title:{text:this.textFormat(o.text),style:{color:e,fontSize:"14px"}},lineColor:e,labels:{style:{color:e},align:"left",x:14},lineWidth:2,opposite:!0},o.range&&(t[i].min=o.range[0],t[i].max=o.range[1]),s[i]={id:o.data,yAxis:i,type:o.type?o.type:"spline",name:this.textFormat(o.text),color:e,lineWidth:1,data:[]}}),this.options.series=s,this.options.yAxis=t,await axios.get(this.url,{params:this.params}).then(o=>{o.data.data.forEach(e=>{let n=Date.parse(e.terminal_time),c=JSON.parse(e.data);for(const l in c){let r=this.options.series.findIndex(p=>p.id===l);r>=0&&this.options.series[r].data.push([n,parseInt(c[l])])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")}}},mt={class:"report"},ft={class:"table-wrapper"},_t={class:"toolbox"},gt={class:"chart"};function yt(s,t,o,i,e,n){const c=m("dropdown"),l=m("highcharts");return d(),h("div",mt,[a("div",ft,[a("div",_t,[u(c,{options:o.columns,onChecked:n.selected,default:o.defaultData},null,8,["options","onChecked","default"])]),a("div",gt,[u(l,{ref:"chart","constructor-type":"stockChart",class:"hc",options:e.options},null,8,["options"])])])])}const vt=g(ut,[["render",yt]]);const bt={props:{url:String,export:String,headers:Array,title:String},components:{Vue3EasyDataTable:L,Datepicker:w},data(){return{options:{page:1,rowsPerPage:25},params:{from:new Date,to:new Date,interval:60},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){let s=Object.assign(this.params,this.options);this.isLoading=!0,this.items=[];let t=await axios.get(this.url,{params:s}).then(o=>o.data);this.items=t.data,this.dataLength=t.meta.total,this.options.page=t.meta.current_page,this.options.rowsPerPage=t.meta.per_page,this.isLoading=!1},download(){let s=this.export.split("?");const t=new URLSearchParams(s[1]);t.append("interval",this.params.interval),t.append("from",this.params.from.toISOString()),t.append("to",this.params.to.toISOString()),window.open(s[0]+"?"+t.toString(),"_blank")}}},xt={class:"report"},wt={class:"table-wrapper"},Dt={class:"toolbox"},Ct={class:"title"},kt={class:"date-selected"},At=V('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),St=[At],qt={class:"table-content"};function Vt(s,t,o,i,e,n){const c=m("datepicker"),l=m("Vue3EasyDataTable");return d(),h("div",xt,[a("div",wt,[a("div",Dt,[a("h2",Ct,_(o.title),1),a("div",kt,[u(c,{class:"mr-2",modelValue:e.params.from,"onUpdate:modelValue":t[0]||(t[0]=r=>e.params.from=r),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),u(c,{class:"mr-2",modelValue:e.params.to,"onUpdate:modelValue":t[1]||(t[1]=r=>e.params.to=r),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),v(a("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>e.params.interval=r),class:"form-control wd-80 mr-2"},St,512),[[q,e.params.interval]]),a("button",{class:"btn btn-primary mr-2",onClick:t[3]||(t[3]=(...r)=>n.fetchData&&n.fetchData(...r))},"Show"),a("button",{class:"btn btn-success",onClick:t[4]||(t[4]=(...r)=>n.download&&n.download(...r))},"Download")])]),a("div",qt,[u(l,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":e.options,"onUpdate:server-options":t[5]||(t[5]=r=>e.options=r),"server-items-length":e.dataLength,loading:e.isLoading,headers:o.headers,items:e.items,ref:"vtable"},$({_:2},[b(s.$slots,(r,p)=>({name:p,fn:O(y=>[P(s.$slots,p,T(U(y||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const Lt=g(bt,[["render",Vt]]);const $t={props:{url:String,headers:Array,title:String},components:{Vue3EasyDataTable:L},data(){return{options:{page:1,rowsPerPage:25},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){this.isLoading=!0,this.items=[];let s=await axios.get(this.url,{params:this.options}).then(t=>t.data);this.items=s.data,this.dataLength=s.meta.total,this.options.page=s.meta.current_page,this.options.rowsPerPage=s.meta.per_page,this.isLoading=!1}}},Ot={class:"report"},Pt={class:"table-wrapper"},Tt={class:"toolbox"},Ut={class:"title"},Ft=a("div",{class:"date-selected"},null,-1),It={class:"table-content"};function zt(s,t,o,i,e,n){const c=m("Vue3EasyDataTable");return d(),h("div",Ot,[a("div",Pt,[a("div",Tt,[a("h2",Ut,_(o.title),1),Ft]),a("div",It,[u(c,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":e.options,"onUpdate:server-options":t[0]||(t[0]=l=>e.options=l),"server-items-length":e.dataLength,loading:e.isLoading,headers:o.headers,items:e.items,ref:"vtable"},$({_:2},[b(s.$slots,(l,r)=>({name:r,fn:O(p=>[P(s.$slots,r,T(U(p||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const Et=g($t,[["render",zt]]),jt={props:{topic:String},data(){return{message:null,options:{}}},created(){this.listen()},methods:{listen(){let s=D.exports.connect("ws://192.168.170.87:9001",this.options),t=this;s.on("connect",function(){s.subscribe(t.topic,function(o){o||(console.log("connected"),s.publish(t.topic,"Hello mqtt"))})}),s.on("message",function(o,i){console.log("topic",o),console.log(i.toString()),t.message=i})}}};function Nt(s,t,o,i,e,n){return d(),h("div",null,_(e.message),1)}const Wt=g(jt,[["render",Nt]]);const Rt={props:{title:String,station:String,mqtt:{type:Object,default(){return{url:null,username:null,password:null,topic:null}}}},components:{CircleProgress:j},data(){return{mqttConnection:null,score:0,total:0}},created(){this.mqttConnection=D.exports.connect(this.mqtt.url,{username:this.mqtt.username,password:this.mqtt.password})},mounted(){this.listen()},methods:{listen(){if(this.mqttConnection){let s=this;this.mqttConnection.on("connect",function(){s.mqttConnection.subscribe(s.mqtt.topic,function(t){t||console.log("connected")})}),this.mqttConnection.on("message",this.received)}},received(s,t){let o=JSON.parse(t.toString());o.group==this.station&&(this.score=o.score,this.total=o.detail.record_count,console.log(o.data))}}},Bt={class:"card"},Ht={class:"card-title"},Mt={class:"card-body"},Jt={class:"total"};function Kt(s,t,o,i,e,n){const c=m("circle-progress");return d(),h("div",Bt,[a("div",Ht,_(o.title),1),a("div",Mt,[u(c,{percent:e.score,"show-percent":""},null,8,["percent"]),a("div",Jt,[N("Total Record "),a("b",null,_(e.total),1)])])])}const Xt=g(Rt,[["render",Kt]]),Qt={props:{url:String,title:String,defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Datepicker:w,Dropdown:C},data(){return{items:this.defaultData,params:{from:new Date,to:new Date},data:[],realtime:{},fetchReady:!1,colors:k,options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!0},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{pointFormat:"{series.name}: <b>{point.y:.2f} KWh</b><br/>",crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},mounted(){this.fetchData()},methods:{selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[],o=[];this.items.forEach((i,e)=>{let n=this.colors[e];t[e]={title:{text:this.textFormat(i.text),style:{color:n,fontSize:"16px"}},lineColor:n,labels:{style:{color:n},align:"left",x:14},lineWidth:1,opposite:!0},i.range&&(t[e].min=i.range[0],t[e].max=i.range[1]),s[e]={id:i.data,yAxis:e,type:i.type?i.type:"spline",name:this.textFormat(i.text),color:n,lineWidth:1,data:[]},o[e]=i.data}),this.options.series=s,this.options.yAxis=t,this.params.select=o,await axios.get(this.url,{params:this.params}).then(i=>{let e=i.data.data;for(const[n,c]of Object.entries(e)){let l=this.options.series.findIndex(r=>r.id==n);l>=0&&c.forEach(r=>{this.options.series[l].data.push([r.time*1e3,r.total/1e3])})}}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")}}},Gt={class:"report"},Yt={class:"table-wrapper"},Zt={class:"toolbox"},te={class:"date-selected"},ee={class:"chart"};function se(s,t,o,i,e,n){const c=m("dropdown"),l=m("datepicker"),r=m("highcharts");return d(),h("div",Gt,[a("div",Yt,[a("div",Zt,[u(c,{options:o.columns,onChecked:n.selected,default:o.defaultData},null,8,["options","onChecked","default"]),a("div",te,[u(l,{class:"mr-2","enable-time-picker":!1,modelValue:e.params.from,"onUpdate:modelValue":t[0]||(t[0]=p=>e.params.from=p),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),u(l,{class:"mr-2","enable-time-picker":!1,modelValue:e.params.to,"onUpdate:modelValue":t[1]||(t[1]=p=>e.params.to=p),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),a("button",{class:"btn btn-primary",onClick:t[2]||(t[2]=(...p)=>n.fetchData&&n.fetchData(...p))},"Show")])]),a("div",ee,[u(r,{ref:"chart",class:"hc",options:e.options},null,8,["options"])])])])}const oe=g(Qt,[["render",se]]);W(R);const f=B({mounted(){},data(){return{active:null}}});f.use(H);Object.defineProperty(String.prototype,"capitalize",{value:function(){let s=this.split(" ");for(let t=0;t<s.length;t++)s[t]=s[t][0].toUpperCase()+s[t].substr(1);return s.join(" ")},enumerable:!1});f.config.globalProperties.$filters={textFormat(s){return s.toLowerCase().capitalize()}};f.component("trend-view",ht);f.component("trend-live",vt);f.component("log-table",Lt);f.component("v-table",Et);f.component("v-mqtt",Wt);f.component("pie",Xt);f.component("pwr-trend",oe);f.mount("#app");
