import{a as T,v as O,r as I,w as g,o as d,c as h,b as i,F as U,d as y,e as E,t as v,f as F,g as b,h as u,i as x,j as m,k as w,m as D,D as k,l as C,n as L,p as S,q as A,s as V,u as j,x as z,y as N,H as W}from"./vendor.94e771bd.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function o(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(e){if(e.ep)return;e.ep=!0;const a=o(e);fetch(e.href,a)}})();window.axios=T;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const _=(s,t)=>{const o=s.__vccOpts||s;for(const[n,e]of t)o[n]=e;return o},M={props:{options:Array,default:{type:Array,default:()=>[]}},data(){return{show:!1,selected:this.default}},methods:{showDropdown(){this.show=!this.show},hide(){this.show=!1}},watch:{selected(s){this.$emit("checked",s)}},directives:{clickOutside:O.directive}},R={class:"dd"},H={id:"list1",class:"dropdown-check-list",tabindex:"100"},B={key:0,class:"items"},J=["id","value"],X=["for"];function K(s,t,o,n,e,a){const l=I("click-outside");return g((d(),h("div",R,[i("div",H,[i("span",{class:"anchor form-control",onClick:t[0]||(t[0]=(...c)=>a.showDropdown&&a.showDropdown(...c))},"Select Parameter"),e.show?(d(),h("ul",B,[(d(!0),h(U,null,y(o.options,(c,r)=>(d(),h("li",{key:r},[g(i("input",{type:"checkbox",id:r,value:c,"onUpdate:modelValue":t[1]||(t[1]=p=>e.selected=p)},null,8,J),[[E,e.selected]]),i("label",{for:r},v(s.$filters.textFormat(c.text)),9,X)]))),128))])):F("",!0)])])),[[l,a.hide]])}const q=_(M,[["render",K]]);const $=["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a","#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1"];const Q={props:{url:String,title:String,defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Datepicker:b,Dropdown:q},data(){return{items:this.defaultData,params:{from:new Date,to:new Date,interval:3600,limit:1e3,select:[]},data:[],realtime:{},fetchReady:!1,colors:$,options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!0},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},mounted(){this.fetchData()},methods:{interval(s){this.params.interval=s,this.fetchData()},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[],o=[];this.items.forEach((n,e)=>{let a=this.colors[e];t.push({title:{text:this.textFormat(n.text),style:{color:a}},lineColor:a,labels:{style:{color:a},align:"left",x:14},lineWidth:1,opposite:!0}),s.push({id:n.data,yAxis:e,type:n.type?n.type:"spline",name:this.textFormat(n.text),color:a,lineWidth:1,data:[]}),o.push(n.data)}),this.options.series=s,this.options.yAxis=t,this.params.select=o,await axios.get(this.url,{params:this.params}).then(n=>{n.data.data.forEach(a=>{let l=a.unix_time;for(const c in a){let r=this.options.series.findIndex(p=>p.id===c);r>=0&&this.options.series[r].data.push([l,a[c]])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")}}},Y={class:"report"},G={class:"table-wrapper"},Z={class:"toolbox"},tt={class:"date-selected"},et=w('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),st=[et],ot={class:"chart"};function at(s,t,o,n,e,a){const l=m("dropdown"),c=m("datepicker"),r=m("highcharts");return d(),h("div",Y,[i("div",G,[i("div",Z,[u(l,{options:o.columns,onChecked:a.selected,default:o.defaultData},null,8,["options","onChecked","default"]),i("div",tt,[u(c,{class:"mr-2",type:"datetime",modelValue:e.params.from,"onUpdate:modelValue":t[0]||(t[0]=p=>e.params.from=p),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),u(c,{class:"mr-2",type:"datetime",modelValue:e.params.to,"onUpdate:modelValue":t[1]||(t[1]=p=>e.params.to=p),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),g(i("select",{"onUpdate:modelValue":t[2]||(t[2]=p=>e.params.interval=p),class:"form-control wd-80 mr-2"},st,512),[[x,e.params.interval]]),i("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...p)=>a.fetchData&&a.fetchData(...p))},"Show")])]),i("div",ot,[u(r,{ref:"chart",class:"hc","constructor-type":"stockChart",options:e.options},null,8,["options"])])])])}const nt=_(Q,[["render",at]]),it={props:{url:String,title:String,mqtt:{type:Object,default(s){return{url:null,username:null,password:null,topic:null,timefield:"_terminalTime"}}},defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Dropdown:q},data(){return{items:this.defaultData,mqttConnection:null,colors:$,params:{last:30},options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!1},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},created(){this.mqttConnection=D.exports.connect(this.mqtt.url,{username:this.mqtt.username,password:this.mqtt.password})},mounted(){this.fetchData(),this.listen()},methods:{listen(){if(this.mqttConnection){let s=this;this.mqttConnection.on("connect",function(){s.mqttConnection.subscribe(s.mqtt.topic,function(t){t||console.log("connected")})}),this.mqttConnection.on("message",this.received)}},received(s,t){let o=JSON.parse(t.toString()),n=Date.parse(o[this.mqtt.timefield]);for(const e in o){let a=this.options.series.findIndex(l=>l.id===e);a>=0&&(this.options.series[a].data.shift(),this.options.series[a].data.push([n,parseInt(o[e])]))}},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[];this.mqttI&&this.mqttI.end(),this.items.forEach((o,n)=>{let e=this.colors[n];t.push({title:{text:this.textFormat(o.text),style:{color:e}},lineColor:e,labels:{style:{color:e},align:"left",x:14},lineWidth:1,opposite:!0}),s.push({id:o.data,yAxis:n,type:o.type?o.type:"spline",name:this.textFormat(o.text),color:e,lineWidth:1,data:[]})}),this.options.series=s,this.options.yAxis=t,await axios.get(this.url,{params:this.params}).then(o=>{o.data.data.forEach(e=>{let a=Date.parse(e.terminal_time),l=JSON.parse(e.data);for(const c in l){let r=this.options.series.findIndex(p=>p.id===c);r>=0&&this.options.series[r].data.push([a,parseInt(l[c])])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let o=0;o<t.length;o++)t[o]=t[o][0].toUpperCase()+t[o].substr(1);return t.join(" ")}}},rt={class:"report"},lt={class:"table-wrapper"},ct={class:"toolbox"},pt={class:"chart"};function dt(s,t,o,n,e,a){const l=m("dropdown"),c=m("highcharts");return d(),h("div",rt,[i("div",lt,[i("div",ct,[u(l,{options:o.columns,onChecked:a.selected,default:o.defaultData},null,8,["options","onChecked","default"])]),i("div",pt,[u(c,{ref:"chart","constructor-type":"stockChart",class:"hc",options:e.options},null,8,["options"])])])])}const ht=_(it,[["render",dt]]);const ut={props:{url:String,export:String,headers:Array,title:String},components:{Vue3EasyDataTable:k,Datepicker:b},data(){return{options:{page:1,rowsPerPage:25},params:{from:{month:new Date().getMonth().toString(),year:new Date().getFullYear().toString()},interval:60},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){let s=Object.assign(this.params,this.options);this.isLoading=!0,this.items=[];let t=await axios.get(this.url,{params:s}).then(o=>o.data);this.items=t.data,this.dataLength=t.meta.total,this.options.page=t.meta.current_page,this.options.rowsPerPage=t.meta.per_page,this.isLoading=!1},download(){let s=this.export.split("?");const t=new URLSearchParams(s[1]);t.append("interval",this.params.interval),t.append("month",parseInt(this.params.from.month)+1),t.append("year",parseInt(this.params.from.year)),window.open(s[0]+"?"+t.toString(),"_blank")}}},mt={class:"report"},ft={class:"table-wrapper"},_t={class:"toolbox"},gt={class:"title"},vt={class:"date-selected"},yt=w('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),bt=[yt],xt={class:"table-content"};function wt(s,t,o,n,e,a){const l=m("datepicker"),c=m("Vue3EasyDataTable");return d(),h("div",mt,[i("div",ft,[i("div",_t,[i("h2",gt,v(o.title),1),i("div",vt,[u(l,{class:"mr-2",monthPicker:"",modelValue:e.params.from,"onUpdate:modelValue":t[0]||(t[0]=r=>e.params.from=r),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),g(i("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>e.params.interval=r),class:"form-control wd-80 mr-2"},bt,512),[[x,e.params.interval]]),i("button",{class:"btn btn-primary mr-2",onClick:t[2]||(t[2]=(...r)=>a.fetchData&&a.fetchData(...r))},"Show"),i("button",{class:"btn btn-success",onClick:t[3]||(t[3]=(...r)=>a.download&&a.download(...r))},"Download")])]),i("div",xt,[u(c,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":e.options,"onUpdate:server-options":t[4]||(t[4]=r=>e.options=r),"server-items-length":e.dataLength,loading:e.isLoading,headers:o.headers,items:e.items,ref:"vtable"},C({_:2},[y(s.$slots,(r,p)=>({name:p,fn:L(P=>[S(s.$slots,p,A(V(P||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const Dt=_(ut,[["render",wt]]);const kt={props:{url:String,headers:Array,title:String},components:{Vue3EasyDataTable:k},data(){return{options:{page:1,rowsPerPage:25},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){this.isLoading=!0,this.items=[];let s=await axios.get(this.url,{params:this.options}).then(t=>t.data);this.items=s.data,this.dataLength=s.meta.total,this.options.page=s.meta.current_page,this.options.rowsPerPage=s.meta.per_page,this.isLoading=!1}}},Ct={class:"report"},Lt={class:"table-wrapper"},St={class:"toolbox"},At={class:"title"},Vt=i("div",{class:"date-selected"},null,-1),qt={class:"table-content"};function $t(s,t,o,n,e,a){const l=m("Vue3EasyDataTable");return d(),h("div",Ct,[i("div",Lt,[i("div",St,[i("h2",At,v(o.title),1),Vt]),i("div",qt,[u(l,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":e.options,"onUpdate:server-options":t[0]||(t[0]=c=>e.options=c),"server-items-length":e.dataLength,loading:e.isLoading,headers:o.headers,items:e.items,ref:"vtable"},C({_:2},[y(s.$slots,(c,r)=>({name:r,fn:L(p=>[S(s.$slots,r,A(V(p||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const Pt=_(kt,[["render",$t]]),Tt={props:{topic:String},data(){return{message:null,options:{}}},created(){this.listen()},methods:{listen(){let s=D.exports.connect("ws://192.168.170.87:9001",this.options),t=this;s.on("connect",function(){s.subscribe(t.topic,function(o){o||(console.log("connected"),s.publish(t.topic,"Hello mqtt"))})}),s.on("message",function(o,n){console.log("topic",o),console.log(n.toString()),t.message=n})}}};function Ot(s,t,o,n,e,a){return d(),h("div",null,v(e.message),1)}const It=_(Tt,[["render",Ot]]);j(z);const f=N({mounted(){},data(){return{active:null}}});f.use(W);Object.defineProperty(String.prototype,"capitalize",{value:function(){let s=this.split(" ");for(let t=0;t<s.length;t++)s[t]=s[t][0].toUpperCase()+s[t].substr(1);return s.join(" ")},enumerable:!1});f.config.globalProperties.$filters={textFormat(s){return s.toLowerCase().capitalize()}};f.component("trend-view",nt);f.component("trend-live",ht);f.component("log-table",Dt);f.component("v-table",Pt);f.component("v-mqtt",It);f.mount("#app");
