import{a as b,v as x,b as e,c as f,m as u,D as _,C as w,s as V,h as k,d as E,H as D}from"./vendor.4a0ab857.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();window.axios=b;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const m=(s,t)=>{const n=s.__vccOpts||s;for(const[r,o]of t)n[r]=o;return n},N={props:{options:Array,default:{type:Array,default:()=>[]}},data(){return{show:!1,selected:this.default}},methods:{showDropdown(){this.show=!this.show},hide(){this.show=!1},groupBy(s,t){return s.reduce((n,r,o)=>{var i;return(n[i=t(r,o,s)]||(n[i]=[])).push(r),n},{})}},computed:{groups(){return this.options[0].hasOwnProperty("group")?this.groupBy(this.options,s=>s.group):this.options}},watch:{selected(s){this.$emit("checked",s)}},directives:{clickOutside:x.directive}},C={class:"dd"},S={id:"list1",class:"dropdown-check-list",tabindex:"100"},q={key:0,class:"items"},A={key:0},L=["id","value"],B=["for"],$={key:1},P=["id","value"],O=["for"];function T(s,t,n,r,o,i){const l=e.resolveDirective("click-outside");return e.withDirectives((e.openBlock(),e.createElementBlock("div",C,[e.createElementVNode("div",S,[e.createElementVNode("span",{class:"anchor form-control",onClick:t[0]||(t[0]=(...c)=>i.showDropdown&&i.showDropdown(...c))},"Select Parameter"),o.show?(e.openBlock(),e.createElementBlock("ul",q,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.groups,(c,a)=>(e.openBlock(),e.createElementBlock("li",{key:a},[Array.isArray(c)?(e.openBlock(),e.createElementBlock("div",A,[e.createElementVNode("span",null,e.toDisplayString(a),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(c,(d,h)=>(e.openBlock(),e.createElementBlock("div",{key:h},[e.withDirectives(e.createElementVNode("input",{type:"checkbox",id:h,value:d,"onUpdate:modelValue":t[1]||(t[1]=y=>o.selected=y)},null,8,L),[[e.vModelCheckbox,o.selected]]),e.createElementVNode("label",{for:h},e.toDisplayString(s.$filters.textFormat(d.text)),9,B)]))),128))])):e.createCommentVNode("",!0),Array.isArray(c)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",$,[e.withDirectives(e.createElementVNode("input",{type:"checkbox",id:a,value:c,"onUpdate:modelValue":t[2]||(t[2]=d=>o.selected=d)},null,8,P),[[e.vModelCheckbox,o.selected]]),e.createElementVNode("label",{for:a},e.toDisplayString(s.$filters.textFormat(c.text)),9,O)]))]))),128))])):e.createCommentVNode("",!0)])])),[[l,i.hide]])}const g=m(N,[["render",T]]);const v=["#2f7ed8","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a","#7cb5ec","#434348","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#2b908f","#f45b5b","#91e8e1","#0d233a"];const U={props:{url:String,title:String,defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Datepicker:f,Dropdown:g},data(){return{items:this.defaultData,params:{from:new Date,to:new Date,interval:3600,limit:1e3,select:[]},data:[],realtime:{},fetchReady:!1,colors:v,options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!0},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{pointFormat:"{series.name}: <b>{point.y:.2f}</b><br/>",crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},mounted(){this.fetchData()},methods:{interval(s){this.params.interval=s,this.fetchData()},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[],n=[];this.items.forEach((r,o)=>{let i=this.colors[o];t[o]={title:{text:this.textFormat(r.text),style:{color:i,fontSize:"16px"}},lineColor:i,labels:{style:{color:i},align:"left",x:14},lineWidth:1,opposite:!0},r.range&&(t[o].min=r.range[0],t[o].max=r.range[1]),s[o]={id:r.data,yAxis:o,type:r.type?r.type:"spline",name:this.textFormat(r.text),color:i,lineWidth:1,data:[]},n[o]=r.data}),this.options.series=s,this.options.yAxis=t,this.params.select=n,await axios.get(this.url,{params:this.params}).then(r=>{r.data.data.forEach(i=>{let l=i.unix_time;for(const c in i){let a=this.options.series.findIndex(d=>d.id===c);a>=0&&this.options.series[a].data.push([l,i[c]])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let n=0;n<t.length;n++)t[n]=t[n][0].toUpperCase()+t[n].substr(1);return t.join(" ")}}},I={class:"report"},F={class:"table-wrapper"},z={class:"toolbox"},j={class:"date-selected"},M=e.createStaticVNode('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),R=[M],W={class:"chart"};function H(s,t,n,r,o,i){const l=e.resolveComponent("dropdown"),c=e.resolveComponent("datepicker"),a=e.resolveComponent("highcharts");return e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",F,[e.createElementVNode("div",z,[e.createVNode(l,{options:n.columns,onChecked:i.selected,default:n.defaultData},null,8,["options","onChecked","default"]),e.createElementVNode("div",j,[e.createVNode(c,{class:"mr-2",type:"datetime",modelValue:o.params.from,"onUpdate:modelValue":t[0]||(t[0]=d=>o.params.from=d),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),e.createVNode(c,{class:"mr-2",type:"datetime",modelValue:o.params.to,"onUpdate:modelValue":t[1]||(t[1]=d=>o.params.to=d),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":t[2]||(t[2]=d=>o.params.interval=d),class:"form-control wd-80 mr-2"},R,512),[[e.vModelSelect,o.params.interval]]),e.createElementVNode("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...d)=>i.fetchData&&i.fetchData(...d))},"Show")])]),e.createElementVNode("div",W,[e.createVNode(a,{ref:"chart",class:"hc","constructor-type":"stockChart",options:o.options},null,8,["options"])])])])}const J=m(U,[["render",H]]),X={props:{url:String,title:String,mqtt:{type:Object,default(s){return{url:null,username:null,password:null,topic:null,timefield:"_terminalTime"}}},defaultData:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},components:{Dropdown:g},data(){return{items:this.defaultData,mqttConnection:null,colors:v,params:{last:30},options:{chart:{type:"line",zoomType:"x",height:600},time:{useUTC:!1},title:{text:this.title,style:{fontSize:"24px",fontWeight:"bold"}},xAxis:{type:"datetime",title:{text:""}},yAxis:[],tooltip:{pointFormat:"{series.name}: <b>{point.y:.2f}</b><br/>",crosshairs:!0,shared:!0},legend:{enabled:!0},series:[]}}},created(){this.mqttConnection=u.exports.connect(this.mqtt.url,{username:this.mqtt.username,password:this.mqtt.password})},mounted(){this.fetchData(),this.listen()},methods:{listen(){if(this.mqttConnection){let s=this;this.mqttConnection.on("connect",function(){s.mqttConnection.subscribe(s.mqtt.topic,function(t){t||console.log("connected")})}),this.mqttConnection.on("message",this.received)}},received(s,t){let n=JSON.parse(t.toString()),r=this.mqtt.timefield?this.mqtt.timefield:"_terminalTime",o=Date.parse(n[r]);for(const i in n){let l=this.options.series.findIndex(c=>c.id===i);l>=0&&(this.options.series[l].data.shift(),this.options.series[l].data.push([o,parseInt(n[i])]))}},selected(s){this.items=s,this.fetchData()},async fetchData(){this.$refs.chart.chart.showLoading();let s=[],t=[];this.mqttI&&this.mqttI.end(),this.items.forEach((n,r)=>{let o=this.colors[r];t[r]={title:{text:this.textFormat(n.text),style:{color:o,fontSize:"14px"}},lineColor:o,labels:{style:{color:o},align:"left",x:14},lineWidth:2,opposite:!0},n.range&&(t[r].min=n.range[0],t[r].max=n.range[1]),s[r]={id:n.data,yAxis:r,type:n.type?n.type:"spline",name:this.textFormat(n.text),color:o,lineWidth:1,data:[]}}),this.options.series=s,this.options.yAxis=t,await axios.get(this.url,{params:this.params}).then(n=>{n.data.data.forEach(o=>{let i=Date.parse(o.terminal_time),l=JSON.parse(o.data);for(const c in l){let a=this.options.series.findIndex(d=>d.id===c);a>=0&&this.options.series[a].data.push([i,parseInt(l[c])])}})}),this.$refs.chart.chart.hideLoading()},textFormat(s){let t=s.toLowerCase().split(" ");for(let n=0;n<t.length;n++)t[n]=t[n][0].toUpperCase()+t[n].substr(1);return t.join(" ")}}},K={class:"report"},Q={class:"table-wrapper"},G={class:"toolbox"},Y={class:"chart"};function Z(s,t,n,r,o,i){const l=e.resolveComponent("dropdown"),c=e.resolveComponent("highcharts");return e.openBlock(),e.createElementBlock("div",K,[e.createElementVNode("div",Q,[e.createElementVNode("div",G,[e.createVNode(l,{options:n.columns,onChecked:i.selected,default:n.defaultData},null,8,["options","onChecked","default"])]),e.createElementVNode("div",Y,[e.createVNode(c,{ref:"chart","constructor-type":"stockChart",class:"hc",options:o.options},null,8,["options"])])])])}const ee=m(X,[["render",Z]]);const te={props:{url:String,export:String,headers:Array,title:String},components:{Vue3EasyDataTable:_,Datepicker:f},data(){return{options:{page:1,rowsPerPage:25},params:{from:new Date,to:new Date,interval:60},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){let s=Object.assign(this.params,this.options);this.isLoading=!0,this.items=[];let t=await axios.get(this.url,{params:s}).then(n=>n.data);this.items=t.data,this.dataLength=t.meta.total,this.options.page=t.meta.current_page,this.options.rowsPerPage=t.meta.per_page,this.isLoading=!1},download(){let s=this.export.split("?");const t=new URLSearchParams(s[1]);t.append("interval",this.params.interval),t.append("from",this.params.from.toISOString()),t.append("to",this.params.to.toISOString()),window.open(s[0]+"?"+t.toString(),"_blank")}}},oe={class:"report"},se={class:"table-wrapper"},ne={class:"toolbox"},ie={class:"title"},re={class:"date-selected"},ae=e.createStaticVNode('<option value="10">10s</option><option value="60">1m</option><option value="900">15m</option><option value="1800">30m</option><option value="3600">1h</option><option value="7200">2h</option><option value="10800">3h</option><option value="18000">5h</option><option value="36000">10h</option><option value="86400">24h</option>',10),le=[ae],ce={class:"table-content"};function de(s,t,n,r,o,i){const l=e.resolveComponent("datepicker"),c=e.resolveComponent("Vue3EasyDataTable");return e.openBlock(),e.createElementBlock("div",oe,[e.createElementVNode("div",se,[e.createElementVNode("div",ne,[e.createElementVNode("h2",ie,e.toDisplayString(n.title),1),e.createElementVNode("div",re,[e.createVNode(l,{class:"mr-2",modelValue:o.params.from,"onUpdate:modelValue":t[0]||(t[0]=a=>o.params.from=a),name:"from",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"from"},null,8,["modelValue"]),e.createVNode(l,{class:"mr-2",modelValue:o.params.to,"onUpdate:modelValue":t[1]||(t[1]=a=>o.params.to=a),name:"to",textInput:"",autoApply:"",closeOnAutoApply:!1,placeholder:"to"},null,8,["modelValue"]),e.withDirectives(e.createElementVNode("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.params.interval=a),class:"form-control wd-80 mr-2"},le,512),[[e.vModelSelect,o.params.interval]]),e.createElementVNode("button",{class:"btn btn-primary mr-2",onClick:t[3]||(t[3]=(...a)=>i.fetchData&&i.fetchData(...a))},"Show"),e.createElementVNode("button",{class:"btn btn-success",onClick:t[4]||(t[4]=(...a)=>i.download&&i.download(...a))},"Download")])]),e.createElementVNode("div",ce,[e.createVNode(c,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":o.options,"onUpdate:server-options":t[5]||(t[5]=a=>o.options=a),"server-items-length":o.dataLength,loading:o.isLoading,headers:n.headers,items:o.items,ref:"vtable"},e.createSlots({_:2},[e.renderList(s.$slots,(a,d)=>({name:d,fn:e.withCtx(h=>[e.renderSlot(s.$slots,d,e.normalizeProps(e.guardReactiveProps(h||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const pe=m(te,[["render",de]]);const me={props:{url:String,headers:Array,title:String},components:{Vue3EasyDataTable:_},data(){return{options:{page:1,rowsPerPage:25},dataLength:0,isLoading:!1,items:[]}},mounted(){this.fetchData()},watch:{options:{handler(s){this.fetchData()},deep:!0}},methods:{async fetchData(){this.isLoading=!0,this.items=[];let s=await axios.get(this.url,{params:this.options}).then(t=>t.data);this.items=s.data,this.dataLength=s.meta.total,this.options.page=s.meta.current_page,this.options.rowsPerPage=s.meta.per_page,this.isLoading=!1}}},he={class:"report"},ue={class:"table-wrapper"},fe={class:"toolbox"},_e={class:"title"},ge=e.createElementVNode("div",{class:"date-selected"},null,-1),ve={class:"table-content"};function ye(s,t,n,r,o,i){const l=e.resolveComponent("Vue3EasyDataTable");return e.openBlock(),e.createElementBlock("div",he,[e.createElementVNode("div",ue,[e.createElementVNode("div",fe,[e.createElementVNode("h2",_e,e.toDisplayString(n.title),1),ge]),e.createElementVNode("div",ve,[e.createVNode(l,{"show-index":"","buttons-pagination":"","table-class-name":"customize-table","server-options":o.options,"onUpdate:server-options":t[0]||(t[0]=c=>o.options=c),"server-items-length":o.dataLength,loading:o.isLoading,headers:n.headers,items:o.items,ref:"vtable"},e.createSlots({_:2},[e.renderList(s.$slots,(c,a)=>({name:a,fn:e.withCtx(d=>[e.renderSlot(s.$slots,a,e.normalizeProps(e.guardReactiveProps(d||{})))])}))]),1032,["server-options","server-items-length","loading","headers","items"])])])])}const be=m(me,[["render",ye]]),xe={props:{topic:String},data(){return{message:null,options:{}}},created(){this.listen()},methods:{listen(){let s=u.exports.connect("ws://192.168.170.87:9001",this.options),t=this;s.on("connect",function(){s.subscribe(t.topic,function(n){n||(console.log("connected"),s.publish(t.topic,"Hello mqtt"))})}),s.on("message",function(n,r){console.log("topic",n),console.log(r.toString()),t.message=r})}}};function we(s,t,n,r,o,i){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(o.message),1)}const Ve=m(xe,[["render",we]]);const ke={props:{title:String,station:String,mqtt:{type:Object,default(){return{url:null,username:null,password:null,topic:null}}}},components:{CircleProgress:w},data(){return{mqttConnection:null,score:0,total:0}},created(){this.mqttConnection=u.exports.connect(this.mqtt.url,{username:this.mqtt.username,password:this.mqtt.password})},mounted(){this.listen()},methods:{listen(){if(this.mqttConnection){let s=this;this.mqttConnection.on("connect",function(){s.mqttConnection.subscribe(s.mqtt.topic,function(t){t||console.log("connected")})}),this.mqttConnection.on("message",this.received)}},received(s,t){let n=JSON.parse(t.toString());n.group==this.station&&(this.score=n.score,this.total=n.detail.record_count,console.log(n.data))}}},Ee={class:"card"},De={class:"card-title"},Ne={class:"card-body"},Ce={class:"total"};function Se(s,t,n,r,o,i){const l=e.resolveComponent("circle-progress");return e.openBlock(),e.createElementBlock("div",Ee,[e.createElementVNode("div",De,e.toDisplayString(n.title),1),e.createElementVNode("div",Ne,[e.createVNode(l,{percent:o.score,"show-percent":""},null,8,["percent"]),e.createElementVNode("div",Ce,[e.createTextVNode("Total Record "),e.createElementVNode("b",null,e.toDisplayString(o.total),1)])])])}const qe=m(ke,[["render",Se]]);V(k);const p=E({mounted(){},data(){return{active:null}}});p.use(D);Object.defineProperty(String.prototype,"capitalize",{value:function(){let s=this.split(" ");for(let t=0;t<s.length;t++)s[t]=s[t][0].toUpperCase()+s[t].substr(1);return s.join(" ")},enumerable:!1});p.config.globalProperties.$filters={textFormat(s){return s.toLowerCase().capitalize()}};p.component("trend-view",J);p.component("trend-live",ee);p.component("log-table",pe);p.component("v-table",be);p.component("v-mqtt",Ve);p.component("pie",qe);p.mount("#app");
